regmatches(X[1], regexec(pattern, X[1], perl = TRUE))
regmatches(X, regexec(pattern, X, perl = TRUE))
X
pattern
spectral.measures <- spectral.measures[-which(spectral.measures$spettro == 6),]
pattern <- "^[[:digit:]]*$"
spectral.measures <- spectral.measures |> dplyr::select(grep(pattern, colnames(spectral.measures), value = TRUE))
data.long <- spectral.measures[1:5, 5] |> pivot_longer(cols = everything(), names_to = "variabile", values_to = "valore")
density.comparation(data.long)
spectral.measures <- spectral.measures[-which(spectral.measures$spettro == 6),]
pattern <- "^[[:digit:]]*$"
spectral.measures <- spectral.measures |> dplyr::select(grep(pattern, colnames(spectral.measures), value = TRUE))
data.long <- spectral.measures[1:5, 5] |> pivot_longer(cols = everything(), names_to = "variabile", values_to = "valore")
density.comparation(data.long)
debugSource("~/Desktop/NIR/code/plot.R")
spectral.measures <- spectral.measures[-which(spectral.measures$spettro == 6),]
spectral.measures <- spectral.measures[-which(spectral.measures$spettro == 6),]
pattern <- "^[[:digit:]]*$"
spectral.measures <- spectral.measures |> dplyr::select(grep(pattern, colnames(spectral.measures), value = TRUE))
data.long <- spectral.measures[1:5, 5] |> pivot_longer(cols = everything(), names_to = "variabile", values_to = "valore")
density.comparation(data.long)
data <- read_excel("data/raw/Dati filetti.xlsx")
data.lightness <- read_excel("data/raw/Dati luminosità.xlsx")
spectral.measures <- read_excel("data/raw/Spettri.xlsx")
pattern <- "^[[:alpha:]]\\*?$"
data.for.compare <- data.lightness |> dplyr::select(grep(pattern, colnames(data.lightness), value = TRUE))
data.norm <- as_tibble(apply(data.for.compare[1:5, ], MARGIN = 2, FUN = normalization))
data.long <- data.norm |> pivot_longer(cols = everything(), names_to = "variabile", values_to = "valore")
density.comparation(data.long)
source("~/Desktop/NIR/source_all.R")
source("settings.R")
lapply(list.files("code",
pattern = "\\.R$",
ignore.case = TRUE,
full.names = TRUE,
recursive = TRUE),
source
)
data <- read_excel("data/raw/Dati filetti.xlsx")
data.lightness <- read_excel("data/raw/Dati luminosità.xlsx")
spectral.measures <- read_excel("data/raw/Spettri.xlsx")
pattern <- "^[[:alpha:]]\\*?$"
data.for.compare <- data.lightness |> dplyr::select(grep(pattern, colnames(data.lightness), value = TRUE))
data.norm <- as_tibble(apply(data.for.compare[1:5, ], MARGIN = 2, FUN = normalization))
data.long <- data.norm |> pivot_longer(cols = everything(), names_to = "variabile", values_to = "valore")
density.comparation(data.long)
spectral.measures <- spectral.measures[-which(spectral.measures$spettro == 6),]
pattern <- "^[[:digit:]]*$"
spectral.measures <- spectral.measures |> dplyr::select(grep(pattern, colnames(spectral.measures), value = TRUE))
data.long <- spectral.measures[1:5, 5] |> pivot_longer(cols = everything(), names_to = "variabile", values_to = "valore")
density.comparation(data.long)
data.long <- spectral.measures[1:5, sample(length(colnames(spectral.measures)), 10)] |> pivot_longer(cols = everything(), names_to = "variabile", values_to = "valore")
density.comparation(data.long)
source("settings.R")
source("source_all.R")
if (!file.exists("data/intermediate/data analysis.rds")) {
build_data_main()
}
data.analysis <- readRDS("data/intermediate/data analysis.rds")
knitr::include_graphics("plot/densities.png")
source("settings.R")
source("source_all.R")
if (!file.exists("data/intermediate/data analysis.rds")) {
build_data_main()
}
data.analysis <- readRDS("data/intermediate/data analysis.rds")
knitr::include_graphics("plot/densities1.png")
source("settings.R")
source("source_all.R")
if (!file.exists("data/intermediate/data analysis.rds")) {
build_data_main()
}
data.analysis <- readRDS("data/intermediate/data analysis.rds")
knitr::include_graphics("plot/densities1.png")
knitr::include_graphics("plot/densities2.png")
source("settings.R")
source("source_all.R")
if (!file.exists("data/intermediate/data analysis.rds")) {
build_data_main()
}
data.analysis <- readRDS("data/intermediate/data analysis.rds")
knitr::include_graphics("plot/densities1.png")
knitr::include_graphics("plot/densities2.png")
knitr::include_graphics("plot/imputation_7_K value.png")
if (!FALSE) print("hello")
source("settings.R")
lapply(list.files("code",
pattern = "\\.R$",
ignore.case = TRUE,
full.names = TRUE,
recursive = TRUE),
source
)
source("settings.R")
source("source_all.R")
if (!file.exists("data/intermediate/data analysis.rds")) {
build_data_main()
}
data.analysis <- readRDS("data/intermediate/data analysis.rds")
knitr::include_graphics("plot/densities1.png")
knitr::include_graphics("plot/densities2.png")
source("settings.R")
lapply(list.files("code",
pattern = "\\.R$",
ignore.case = TRUE,
full.names = TRUE,
recursive = TRUE),
source
)
source("settings.R")
source("source_all.R")
if (!file.exists("data/intermediate/data analysis.rds")) {
build_data_main()
}
data.analysis <- readRDS("data/intermediate/data analysis.rds")
knitr::include_graphics("plot/densities1.png")
knitr::include_graphics("plot/densities2.png")
knitr::include_graphics("plot/imputation_7_K value.png")
source("settings.R")
source("source_all.R")
if (!file.exists("data/intermediate/data analysis.rds")) {
build_data_main()
}
data.analysis <- readRDS("data/intermediate/data analysis.rds")
knitr::include_graphics("plot/densities1.png")
knitr::include_graphics("plot/densities2.png")
knitr::include_graphics("plot/imputation_7_K value.png")
data.imputed <- readRDS("data/intermediate/data imputed.rds")
source("settings.R")
source("source_all.R")
if (!file.exists("data/intermediate/data analysis.rds")) {
build_data_main()
}
data.analysis <- readRDS("data/intermediate/data analysis.rds")
knitr::include_graphics("plot/densities1.png")
knitr::include_graphics("plot/densities2.png")
knitr::include_graphics("plot/imputation_7_K value.png")
data.imputed <- readRDS("data/intermediate/data imputated.rds")
View(data.imputed)
data.analysis <- readRDS("data/intermediate/data analysis.rds")
cor.data <- data.analysis |> dplyr::select(!c(sample, class))
corr_Kvalue <- cor(cor.data)["K value",]
top.cor <- sort(abs(corr_Kvalue), decreasing = TRUE)
top.cor <- head(top.cor, 10)
data.cluster <- data.analysis |> dplyr::select(grep("^[[:digit:]]*$", names(top.cor), value = TRUE), class)
task <- TaskClassif$new(
id = "Classification original data",
backend = data.cluster,
target = "class",
positive = "fresco"
)
task$col_roles$stratum <- "class"
results1.lda <- model_lda(task)
results1.qda <- model_qda(task)
results1.lda$performance
results1.knn <- tune_knn(task)
results1.knn$nested_performance
results1.lda$performance
results1.qda$performance
rbind(results1.lda$performance,
results1.qda$performance,
results1.knn$nested_performance
)
results1 <- rbind(results1.lda$performance,
results1.qda$performance,
results1.knn$nested_performance
)
rownames(results1) <- c("LDA", "QDA", "k-NN")
results1
saveRDS(results1, file = "data/results/results correlation.rds")
results1.knn$model
results1.knn$best_params
results1.knn$resampling_result
results1.knn$confusion_matrix
performance <- rbind(
results1.lda$performance,
results1.qda$performance,
results1.knn$nested_performance
)
rownames(performance) <- c("LDA", "QDA", "k-NN")
# Confusion matrix
confusion <- list(
LDA  = results1.lda$prediction$confusion,
QDA  = results1.qda$prediction$confusion,
kNN  = results1.knn$prediction$confusion
)
# Learners and parameters
learners <- list(
LDA = results1.lda$learner,
QDA = results1.qda$learner,
kNN = results1.knn$learner
)
# Output
results <- list(
performance = performance,
confusion   = confusion,
learners    = learners
)
saveRDS(results, file = "data/results/results correlation.rds")
invisible(results)
data.cluster <- data.analysis |> dplyr::select(grep("^[[:digit:]]*$", names(top.cor), value = TRUE), class)
str(data.cluster)
cor.data <- data.analysis |> dplyr::select(!c(sample, class))
corr_Kvalue <- cor(cor.data)["K value",]
top.cor <- sort(abs(corr_Kvalue), decreasing = TRUE)
top.cor <- head(top.cor, 10)
data.cluster <- data.analysis |> dplyr::select(grep("^[[:digit:]]*$", names(top.cor), value = TRUE))
colnames(data.cluster) <- paste0("V", colnames(data.cluster))
data.cluster <- bind_cols(data.cluster, class = data.analysis$class)
task <- TaskClassif$new(
id = "Classification original data",
backend = data.cluster,
target = "class",
positive = "fresco"
)
task$col_roles$stratum <- "class"
if (!file.exists("data/results/results correlation.rds")) {
cor.analysis(task)
}
results.cor <- readRDS("data/results/results correlation.rds")
top.features <- feature.selection(task)
data.cluster <- data.cluster |> dplyr::select(top.features, class)
source("settings.R")
source("source_all.R")
if (!file.exists("data/intermediate/data analysis.rds")) {
build_data_main()
}
data.analysis <- readRDS("data/intermediate/data analysis.rds")
knitr::include_graphics("plot/densities1.png")
knitr::include_graphics("plot/densities2.png")
knitr::include_graphics("plot/imputation_7_K value.png")
data.imputed <- readRDS("data/intermediate/data imputated.rds")
cor.data <- data.analysis |> dplyr::select(!c(sample, class))
corr_Kvalue <- cor(cor.data)["K value",]
top.cor <- sort(abs(corr_Kvalue), decreasing = TRUE)
top.cor <- head(top.cor, 10)
data.cluster <- data.analysis |> dplyr::select(grep("^[[:digit:]]*$", names(top.cor), value = TRUE))
colnames(data.cluster) <- paste0("V", colnames(data.cluster))
data.cluster <- bind_cols(data.cluster, class = data.analysis$class)
task <- TaskClassif$new(
id = "Classification original data",
backend = data.cluster,
target = "class",
positive = "fresco"
)
task$col_roles$stratum <- "class"
if (!file.exists("data/results/results correlation.rds")) {
cor.analysis(task)
}
results.cor <- readRDS("data/results/results correlation.rds")
top.features <- feature.selection(task)
data.cluster <- data.cluster |> dplyr::select(top.features, class)
source("settings.R")
source("source_all.R")
if (!file.exists("data/intermediate/data analysis.rds")) {
build_data_main()
}
data.analysis <- readRDS("data/intermediate/data analysis.rds")
knitr::include_graphics("plot/densities1.png")
knitr::include_graphics("plot/densities2.png")
knitr::include_graphics("plot/imputation_7_K value.png")
data.imputed <- readRDS("data/intermediate/data imputated.rds")
cor.data <- data.analysis |> dplyr::select(!c(sample, class))
corr_Kvalue <- cor(cor.data)["K value",]
top.cor <- sort(abs(corr_Kvalue), decreasing = TRUE)
top.cor <- head(top.cor, 10)
data.cluster <- data.analysis |> dplyr::select(grep("^[[:digit:]]*$", names(top.cor), value = TRUE))
colnames(data.cluster) <- paste0("V", colnames(data.cluster))
data.cluster <- bind_cols(data.cluster, class = data.analysis$class)
task <- TaskClassif$new(
id = "Classification original data",
backend = data.cluster,
target = "class",
positive = "fresco"
)
task$col_roles$stratum <- "class"
if (!file.exists("data/results/results correlation.rds")) {
cor.analysis(task)
}
results.cor <- readRDS("data/results/results correlation.rds")
top.features <- feature.selection(task)
data.cluster <- data.cluster |> dplyr::select(top.features, class)
source("settings.R")
source("source_all.R")
if (!file.exists("data/intermediate/data analysis.rds")) {
build_data_main()
}
data.analysis <- readRDS("data/intermediate/data analysis.rds")
knitr::include_graphics("plot/densities1.png")
knitr::include_graphics("plot/densities2.png")
knitr::include_graphics("plot/imputation_7_K value.png")
data.imputed <- readRDS("data/intermediate/data imputated.rds")
cor.data <- data.analysis |> dplyr::select(!c(sample, class))
corr_Kvalue <- cor(cor.data)["K value",]
top.cor <- sort(abs(corr_Kvalue), decreasing = TRUE)
top.cor <- head(top.cor, 10)
data.cluster <- data.analysis |> dplyr::select(grep("^[[:digit:]]*$", names(top.cor), value = TRUE))
colnames(data.cluster) <- paste0("V", colnames(data.cluster))
data.cluster <- bind_cols(data.cluster, class = data.analysis$class)
task <- TaskClassif$new(
id = "Classification original data",
backend = data.cluster,
target = "class",
positive = "fresco"
)
task$col_roles$stratum <- "class"
if (!file.exists("data/results/results correlation.rds")) {
cor.analysis(task)
}
results.cor <- readRDS("data/results/results correlation.rds")
top.features <- feature.selection(task)
data.cluster <- data.cluster |> dplyr::select(top.features, class)
source("settings.R")
source("source_all.R")
if (!file.exists("data/intermediate/data analysis.rds")) {
build_data_main()
}
data.analysis <- readRDS("data/intermediate/data analysis.rds")
knitr::include_graphics("plot/densities1.png")
knitr::include_graphics("plot/densities2.png")
knitr::include_graphics("plot/imputation_7_K value.png")
data.imputed <- readRDS("data/intermediate/data imputated.rds")
source("settings.R")
source("source_all.R")
if (!file.exists("data/intermediate/data analysis.rds")) {
build_data_main()
}
data.analysis <- readRDS("data/intermediate/data analysis.rds")
knitr::include_graphics("plot/densities1.png")
knitr::include_graphics("plot/densities2.png")
knitr::include_graphics("plot/imputation_7_K value.png")
data.imputed <- readRDS("data/intermediate/data imputated.rds")
cor.data <- data.analysis |> dplyr::select(!c(sample, class))
corr_Kvalue <- cor(cor.data)["K value",]
top.cor <- sort(abs(corr_Kvalue), decreasing = TRUE)
top.cor <- head(top.cor, 10)
data.cluster <- data.analysis |> dplyr::select(grep("^[[:digit:]]*$", names(top.cor), value = TRUE))
colnames(data.cluster) <- paste0("V", colnames(data.cluster))
data.cluster <- bind_cols(data.cluster, class = data.analysis$class)
task <- TaskClassif$new(
id = "Classification original data",
backend = data.cluster,
target = "class",
positive = "fresco"
)
task$col_roles$stratum <- "class"
if (!file.exists("data/results/results correlation.rds")) {
cor.analysis(task)
}
results.cor <- readRDS("data/results/results correlation.rds")
top.features <- feature.selection(task)
data.cluster <- data.cluster |> dplyr::select(top.features, class)
task <- TaskClassif$new(
id = "Classification original data",
backend = data.cluster,
target = "class",
positive = "fresco"
)
task$col_roles$stratum <- "class"
if (!file.exists("data/results/results auc.rds")) {
auc.analysis(task)
}
results.auc <- readRDS("data/results/results auc.rds")
results.auc$performance
results.cor$performance
source("settings.R")
source("source_all.R")
if (!file.exists("data/intermediate/data analysis.rds")) {
build_data_main()
}
data.analysis <- readRDS("data/intermediate/data analysis.rds")
knitr::include_graphics("plot/densities1.png")
knitr::include_graphics("plot/densities2.png")
knitr::include_graphics("plot/imputation_7_K value.png")
data.imputed <- readRDS("data/intermediate/data imputated.rds")
cor.data <- data.analysis |> dplyr::select(!c(sample, class))
corr_Kvalue <- cor(cor.data)["K value",]
top.cor <- sort(abs(corr_Kvalue), decreasing = TRUE)
top.cor <- head(top.cor, 10)
data.cluster <- data.analysis |> dplyr::select(grep("^[[:digit:]]*$", names(top.cor), value = TRUE), class)
task <- TaskClassif$new(
id = "Classification original data",
backend = data.cluster,
target = "class",
positive = "fresco"
)
task$col_roles$stratum <- "class"
if (!file.exists("data/results/results correlation.rds")) {
cor.analysis(task)
}
results.cor <- readRDS("data/results/results correlation.rds")
data.cluster <- data.analysis |> dplyr::select(grep("^[[:digit:]]*$", names(top.cor), value = TRUE))
colnames(data.cluster) <- paste0("V", colnames(data.cluster))
data.cluster <- bind_cols(data.cluster, class = data.analysis$class)
task <- TaskClassif$new(
id = "Classification original data",
backend = data.cluster,
target = "class",
positive = "fresco"
)
task$col_roles$stratum <- "class"
top.features <- feature.selection(task)
data.cluster <- data.cluster |> dplyr::select(top.features, class)
task <- TaskClassif$new(
id = "Classification original data",
backend = data.cluster,
target = "class",
positive = "fresco"
)
task$col_roles$stratum <- "class"
if (!file.exists("data/results/results auc.rds")) {
auc.analysis(task)
}
results.auc <- readRDS("data/results/results auc.rds")
results.cor$performance
results.auc$performance
results.auc$confusion
results.auc$learners
results.cor$confusion
source("settings.R")
source("source_all.R")
if (!file.exists("data/intermediate/data analysis.rds")) {
build_data_main()
}
data.analysis <- readRDS("data/intermediate/data analysis.rds")
knitr::include_graphics("plot/densities1.png")
knitr::include_graphics("plot/densities2.png")
knitr::include_graphics("plot/imputation_7_K value.png")
data.imputed <- readRDS("data/intermediate/data imputated.rds")
cor.data <- data.analysis |> dplyr::select(!c(sample, class))
corr_Kvalue <- cor(cor.data)["K value",]
top.cor <- sort(abs(corr_Kvalue), decreasing = TRUE)
top.cor <- head(top.cor, 10)
data.cluster <- data.analysis |> dplyr::select(grep("^[[:digit:]]*$", names(top.cor), value = TRUE), class)
task <- TaskClassif$new(
id = "Classification original data",
backend = data.cluster,
target = "class",
positive = "fresco"
)
task$col_roles$stratum <- "class"
if (!file.exists("data/results/results correlation.rds")) {
cor.analysis(task)
}
results.cor <- readRDS("data/results/results correlation.rds")
results.cor$confusion
results.cor$learners
results.cor$performance
source("settings.R")
source("source_all.R")
if (!file.exists("data/intermediate/data analysis.rds")) {
build_data_main()
}
data.analysis <- readRDS("data/intermediate/data analysis.rds")
knitr::include_graphics("plot/densities1.png")
knitr::include_graphics("plot/densities2.png")
knitr::include_graphics("plot/imputation_7_K value.png")
data.imputed <- readRDS("data/intermediate/data imputated.rds")
cor.data <- data.analysis |> dplyr::select(!c(sample, class))
corr_Kvalue <- cor(cor.data)["K value",]
top.cor <- sort(abs(corr_Kvalue), decreasing = TRUE)
(top.cor <- head(top.cor, 10))
data.cluster <- data.analysis |> dplyr::select(grep("^[[:digit:]]*$", names(top.cor), value = TRUE), class)
task <- TaskClassif$new(
id = "Classification original data",
backend = data.cluster,
target = "class",
positive = "fresco"
)
task$col_roles$stratum <- "class"
if (!file.exists("data/results/results correlation.rds")) {
cor.analysis(task)
}
results.cor <- readRDS("data/results/results correlation.rds")
results.cor$learners
data.cluster <- data.analysis |> dplyr::select(grep("^[[:digit:]]*$", value = TRUE))
data.cluster <- data.analysis |> dplyr::select(grep("^[[:digit:]]*$", colnames(data.analysis) value = TRUE))
colnames(data.cluster) <- paste0("V", colnames(data.cluster))
data.cluster <- bind_cols(data.cluster, class = data.analysis$class)
task <- TaskClassif$new(
id = "Classification original data",
backend = data.cluster,
target = "class",
positive = "fresco"
)
task$col_roles$stratum <- "class"
top.features <- feature.selection(task)
data.cluster <- data.analysis |> dplyr::select(grep("^[[:digit:]]*$", colnames(data.analysis), value = TRUE))
colnames(data.cluster) <- paste0("V", colnames(data.cluster))
data.cluster <- bind_cols(data.cluster, class = data.analysis$class)
task <- TaskClassif$new(
id = "Classification original data",
backend = data.cluster,
target = "class",
positive = "fresco"
)
task$col_roles$stratum <- "class"
top.features <- feature.selection(task)
data.cluster <- data.cluster |> dplyr::select(top.features, class)
task <- TaskClassif$new(
id = "Classification original data",
backend = data.cluster,
target = "class",
positive = "fresco"
)
task$col_roles$stratum <- "class"
if (!file.exists("data/results/results auc.rds")) {
auc.analysis(task)
}
results.auc <- readRDS("data/results/results auc.rds")
results.auc$performance
results.cor$performance
